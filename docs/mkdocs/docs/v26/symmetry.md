# Preliminaries 

In the program we make use of two types of symmetry: 

*    global (space-group) symmetry for the whole crystal (used for symmetrisation of the plane-wave expansion) 
*    point group symmetry: from Version 0.22 on, this is generated automatically. 

FLEUR was developed as a program for surfaces, therefore symmetry is treated differently than in other bandstructure codes: 

*   first consider the two-dimensional symmetry 
*   then add the third (z) dimension. 

This means, e.g. for a Cu(001) surface: 


*   in two dimensions we have a square unit cell (squ) with an inversion center, a four-fold axis and four mirror planes (i.e. p4m symmetry) 
*   in the third dimension (if we take an odd number of layers) we have z-reflection symmetry (zrfs=T) 
*   in total we have inversion symmetry (invs=T) and a vacuum layer has also 2D-inversion symmetry (invs2=T). 

Therefore, in line 3 of the input file we write: 

    squ p4m ,invs=T,zrfs=T,invs2=T
    


Atoms that are connected by symmetry belong to the same atom type! They have to be grouped accordingly, i.e. 



    squ p4m ,invs=T,zrfs=T,invs2=T
             [ ...]
               1
              **********************************
              Cu  29    7    8  421  2.150000   .023
    
               4,force =F,nlo= 0,llo=
                 .250000   .250000   .000000  1.000000
                 .250000  -.250000   .000000  1.000000
                -.250000   .250000   .000000  1.000000
                -.250000  -.250000   .000000  1.000000
              **********************************
    

and not 



    squ p4m ,invs=T,zrfs=T,invs2=T
    

[ ...] 

    4
              **********************************
              Cu  29    7    8  421  2.150000   .023
    
               1,force =F,nlo= 0,llo=
                 .250000   .250000   .000000  1.000000
              **********************************
              Cu  29    7    8  421  2.150000   .023
    
               1,force =F,nlo= 0,llo=
                 .250000  -.250000   .000000  1.000000
              **********************************
              Cu  29    7    8  421  2.150000   .023
    
               1,force =F,nlo= 0,llo=
                -.250000   .250000   .000000  1.000000
              **********************************
              Cu  29    7    8  421  2.150000   .023
    
               1,force =F,nlo= 0,llo=
                -.250000  -.250000   .000000  1.000000
              **********************************

 
 
 
# Bulk-problems And The FLEUR Code

With the exception of some nonsymmorphic space-groups (those with translations different than 1/2), it is now possible to calculate most bulk-structures with full symmetry and to specify general Bravais matrices. When a lattice type and/or symmetry type is not in the list given on the lattice page, you can specify 



    any
    

as a symmetry in the input file. 

Then the program expects a 3x3 Bravais matrix instead of the lattice parameters and a sym.out file with the symmetry operations. This file is generated by the inp-file generator.

 
# Lattice



# In two dimensions, only 5 lattice types can be identified 

*   Square lattice ('squ') 
*   Primitive rectangular l. ('p-r') 
*   Centered rectangular l. ('c-r') 
*   Hexagonal l. ('hex' or 'hx3') 
*   Oblique l. ('obl') 

These lattices are characterized by having either two axes of equal length (a) or a special angle between the two axes (60, 90 or 120 degree): 



    name                 axes   angle   |   input        | typical space groups
     ------
     Square lattice        squ    a   a      90   |    a           | p4,p4m,p4g
     Primitive rectangular p-r    a   b      90   |    a   , b     | pmm,pmg,pgg,pm,pg
     Centered rectangular  c-r    a   a   0-180   |    a/2 , b/2   | cmm,cm
     Hexagonal             hex    a   a      60   |    a           | p6m,p6,p3m1,p3
                           hx3    a   a     120   |    a           |        p31m
     Oblique               obl    a   b   0-180   |    a(1), a(2)  | p1,p2
                                                  |    b(1), b(2)  |
    

For a square and hexagonal lattices you need to specify only one parameter, for rectangular lattices 2, and an oblique lattice requires two lines of input with in total four parameters.

 
# Space-group


In the code all 2-dimensional space groups are available: 



    p1  p2  pm  pg  cm   pmm  pgg pmg cmm 
        p4  p4m p4g p3  p3m1 p31m p6  p6m  
    

These symbols can be understood as a combination of 'p' or 'c', indicating whether we have a primitive or centered cell, a number ( n = 1,2,3,4 or 6) specifying a n-fold rotation axis (normal to the plane) and mirror (m) or gliding-planes (g). 

Important examples: 



*   a perfect quadratic lattice, e.g. on a (001) surface of a cubic crystal, has p4m symmetry: a primitive unit-cell contains a 4-fold axis and diagonal mirror-planes. 
*   a rectangular lattice, e.g. on a (110) surface of a fcc crystal, has pmm symmetry: in a primitive unit-cell two mirror-planes can be found. 
*   the (110) surface of a bcc crystal, on the other hand, has a centered unit cell and, therefore, has cmm symmetry. 
*   a hexagonal monolayer has p6m symmetry: a 6-fold axis plus diagonal mirror-planes. 
*   a film simulating a fcc (111) or a hcp (0001) surface has only p3m1 symmetry 
*   another 3-fold symmetry, p31m , occurs if the mirror planes include the 2D lattice vectors 
*   symmetries with gliding-planes have not been used for a long time - it is uncertain whether everything works properly in this case.

 
# Symmetry In K-space


## General 

The choice of the irreducible wedge of the Brillouin-zone (BZ) is, of course, closely connected with the space-group symmetry. A symmetry like p4/mmm in principle ensures that you only have to sample 1/8 of the 2D-BZ. There is one exception: 



*   use of spin orbit coupling with a general magnetization axis 'breaks' the original symmetry. 

As long as the magnetization axis points in z-direction, (theta = 0.0 and phi = 0.0 and l_soc=T) symmetry is almost preserved (actually it is p4/m, the highest symmetry compatible with an axial vector in z-direction in this case). If the magnetization points in x- or y-direction, the symmetry is lower (pm). 

The influence on the charge density is negligible and in principle the same symmetry as before can be used for charge and potential. But for the calculation of the orbital moments and the magnetic anisotropy the fact, that eigenvectors and -values of originally equivalent k-points are now different matters. Therefore, the sampling of the k-space has to be extended. 



### Inversion Symmetry 

Normally, time-reversal symmetry allows you to use inversion symmetry to reduce your Brillouin zone, even if no inversion center exists in the real space structure. There are two exceptions: 



*   spin orbit coupling again (independent from the orientation of the spin-quantization axis, even in the nonmagnetic case) and 

*   spin-spiral calculations using the generalized Bloch theorem. 

Normally, the automatically generated kpts files take this into account.
