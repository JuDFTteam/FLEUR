<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema" version="0.33">

   <!--Here the FleurInputSchema is included since the out.xml contains a complete dump of the inp.xml!-->
   <xsd:include schemaLocation="FleurInputSchema.xsd"/>
   <xsd:element name="fleurOutput" type="FleurOutputType"/>

   <xsd:complexType name="FleurOutputType">
      <xsd:all>
         <xsd:element maxOccurs="1" minOccurs="0" name="programVersion" type="ProgramVersionType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="parallelizationParameters" type="ParallelizationParametersType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="startDateAndTime" type="DateAndTimeType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="fleurInput" type="FleurInputType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="scfLoop" type="OutSCFLoopType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="endDateAndTime" type="DateAndTimeType"/>
      </xsd:all>
      <xsd:attribute name="fleurOutputVersion" type="FleurVersionType" use="required"/>
   </xsd:complexType>

   <xsd:complexType name="ProgramVersionType">
      <xsd:all>
         <xsd:element maxOccurs="1" minOccurs="0" name="compilationInfo" type="CompilationInfoType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="gitInfo" type="GitInfoType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="targetComputerArchitectures" type="xsd:string"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="precision" type="PrecisionType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="targetStructureClass" type="TargetStructureClassType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="additionalCompilerFlags" type="AdditionalCompilerFlagsType"/>
      </xsd:all>
      <xsd:attribute name="version" type="xsd:string" use="required"/>
   </xsd:complexType>

   <xsd:complexType name="CompilationInfoType">
      <xsd:attribute name="date" type="xsd:string" use="required"/>
      <xsd:attribute name="user" type="xsd:string" use="required"/>
      <xsd:attribute name="host" type="xsd:string" use="required"/>
   </xsd:complexType>

   <xsd:complexType name="GitInfoType">
      <xsd:attribute name="version" type="xsd:string" use="required"/>
      <xsd:attribute name="lastCommitHash" type="xsd:string" use="required"/>
   </xsd:complexType>

   <xsd:complexType name="PrecisionType">
      <xsd:attribute name="type" type="xsd:string" use="required"/>
   </xsd:complexType>

   <xsd:simpleType name="TargetStructureClassType">
      <xsd:list itemType="xsd:string"/>
   </xsd:simpleType>

   <xsd:simpleType name="AdditionalCompilerFlagsType">
      <xsd:list itemType="xsd:string"/>
   </xsd:simpleType>

   <xsd:complexType name="ParallelizationParametersType">
      <xsd:attribute name="mpiPEs" type="xsd:integer" use="required"/>
   </xsd:complexType>

   <xsd:complexType name="DateAndTimeType">
      <xsd:attribute name="date" type="xsd:string" use="required"/>
      <xsd:attribute name="time" type="xsd:string" use="required"/>
      <xsd:attribute name="zone" type="xsd:string" use="required"/>
   </xsd:complexType>

   <xsd:complexType name="OutSCFLoopType">
      <xsd:sequence maxOccurs="unbounded">
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="iteration" type="IterationType"/>
      </xsd:sequence>
   </xsd:complexType>

   <xsd:complexType name="IterationType">
      <xsd:sequence maxOccurs="unbounded">
         <xsd:element maxOccurs="1" minOccurs="0" name="energyParameters" type="OutEnergyParameterType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="eigenvalues" type="EigenvaluesType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="bandgap" type="SingleValueType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="sumValenceSingleParticleEnergies" type="SingleValueType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="FermiEnergy" type="SingleValueType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="valenceDensity" type="ChargeDensityType"/>
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="coreStates" type="OutCoreStatesType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="allElectronCharges" type="ChargeDensityType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="magneticMomentsInMTSpheres" type="MTMagneticMomentsType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="orbitalMagneticMomentsInMTSpheres" type="MTOrbMagneticMomentsType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="totalForcesOnRepresentativeAtoms" type="OutTotalForcesType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="totalEnergy" type="TotalEnergyType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="densityConvergence" type="DensityConvergenceType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="timing" type="TimingType"/>
      </xsd:sequence>
      <xsd:attribute name="numberForCurrentRun" type="xsd:integer" use="required"/>
      <xsd:attribute name="overallNumber" type="xsd:integer" use="optional"/>
   </xsd:complexType>

   <xsd:complexType name="OutEnergyParameterType">
      <xsd:sequence maxOccurs="unbounded">
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="atomicEP" type="AtomicEPType"/>
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="heAtomicEP" type="HEAtomicEPType"/>
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="loAtomicEP" type="AtomicEPType"/>
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="heloAtomicEP" type="HEAtomicEPType"/>
         <xsd:element maxOccurs="2" minOccurs="0" name="vacuumEP" type="VacuumEPType"/>
      </xsd:sequence>
      <xsd:attribute name="units" type="xsd:string" use="required"/>
   </xsd:complexType>

   <xsd:complexType name="AtomicEPType">
      <xsd:attribute name="atomType" type="xsd:integer" use="required"/>
      <xsd:attribute default="1" name="spin" type="xsd:integer" use="optional"/>
      <xsd:attribute name="branch" type="xsd:string" use="required"/>
      <xsd:attribute name="branchLowest" type="xsd:double" use="optional"/>
      <xsd:attribute name="branchHighest" type="xsd:double" use="optional"/>
      <xsd:attribute name="value" type="xsd:double" use="required"/>
   </xsd:complexType>

   <xsd:complexType name="HEAtomicEPType">
      <xsd:attribute name="atomType" type="xsd:integer" use="required"/>
      <xsd:attribute default="1" name="spin" type="xsd:integer" use="optional"/>
      <xsd:attribute name="branch" type="xsd:string" use="required"/>
      <xsd:attribute name="logDerivMT" type="xsd:double" use="optional"/>
      <xsd:attribute name="value" type="xsd:double" use="required"/>
   </xsd:complexType>

   <xsd:complexType name="VacuumEPType">
      <xsd:attribute name="vacuum" type="xsd:integer" use="required"/>
      <xsd:attribute default="1" name="spin" type="xsd:integer" use="optional"/>
      <xsd:attribute name="vzIR" type="xsd:double" use="optional"/>
      <xsd:attribute name="vzInf" type="xsd:double" use="optional"/>
      <xsd:attribute name="value" type="xsd:double" use="required"/>
   </xsd:complexType>

   <xsd:complexType name="EigenvaluesType">
      <xsd:sequence maxOccurs="unbounded">
         <xsd:element maxOccurs="unbounded" minOccurs="1" name="eigenvaluesAt" type="EigenvaluesAtType"/>
      </xsd:sequence>
   </xsd:complexType>

   <xsd:complexType name="EigenvaluesAtType">
      <xsd:simpleContent>
         <xsd:extension base="DoubleVecType">
            <xsd:attribute default="1" name="spin" type="xsd:integer" use="optional"/>
            <xsd:attribute name="ikpt" type="xsd:integer" use="required"/>
            <xsd:attribute name="k_x" type="xsd:double" use="optional"/>
            <xsd:attribute name="k_y" type="xsd:double" use="optional"/>
            <xsd:attribute name="k_z" type="xsd:double" use="optional"/>
         </xsd:extension>
      </xsd:simpleContent>
   </xsd:complexType>

   <xsd:complexType name="SingleValueType">
      <xsd:attribute name="value" type="xsd:double" use="required"/>
      <xsd:attribute name="units" type="xsd:string" use="optional"/>
   </xsd:complexType>

   <xsd:complexType name="ChargeDensityType">
      <xsd:sequence maxOccurs="unbounded">
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="mtCharges" type="MTChargesType"/>
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="spinDependentCharge" type="SpinDependentChargeType"/>         
         <xsd:element maxOccurs="1" minOccurs="0" name="totalCharge" type="SingleValueType"/>
      </xsd:sequence>
   </xsd:complexType>

   <xsd:complexType name="MTChargesType">
      <xsd:sequence maxOccurs="unbounded">
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="mtCharge" type="MTChargeType"/>
      </xsd:sequence>
      <xsd:attribute default="1" name="spin" type="xsd:integer" use="optional"/>
   </xsd:complexType>

   <xsd:complexType name="MTChargeType">
      <xsd:attribute name="atomType" type="xsd:integer" use="required"/>
      <xsd:attribute name="total" type="xsd:double" use="required"/>
      <xsd:attribute name="s" type="xsd:double" use="required"/>
      <xsd:attribute name="p" type="xsd:double" use="required"/>
      <xsd:attribute name="d" type="xsd:double" use="required"/>
      <xsd:attribute name="f" type="xsd:double" use="required"/>
   </xsd:complexType>

   <xsd:complexType name="SpinDependentChargeType">
      <xsd:attribute default="1" name="spin" type="xsd:integer" use="optional"/>
      <xsd:attribute name="total" type="xsd:double" use="required"/>
      <xsd:attribute name="interstitial" type="xsd:double" use="required"/>
      <xsd:attribute name="mtSpheres" type="xsd:double" use="required"/>
      <xsd:attribute name="vacuum1" type="xsd:double" use="optional"/>
      <xsd:attribute name="vacuum2" type="xsd:double" use="optional"/>
   </xsd:complexType>

   <xsd:complexType name="OutCoreStatesType">
      <xsd:sequence maxOccurs="unbounded">
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="state" type="OutStateType"/>
      </xsd:sequence>
      <xsd:attribute name="atomType" type="xsd:integer" use="required"/>
      <xsd:attribute name="atomicNumber" type="xsd:integer" use="required"/>
      <xsd:attribute default="1" name="spin" type="xsd:integer" use="optional"/>
      <xsd:attribute name="kinEnergy" type="xsd:double" use="required"/>
      <xsd:attribute name="eigValSum" type="xsd:double" use="required"/>
      <xsd:attribute name="lostElectrons" type="xsd:double" use="required"/>
   </xsd:complexType>

   <xsd:complexType name="MTMagneticMomentsType">
      <xsd:sequence maxOccurs="unbounded">
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="magneticMoment" type="MagneticMomentType"/>
      </xsd:sequence>
      <xsd:attribute name="units" type="xsd:string" use="optional"/>
   </xsd:complexType>

   <xsd:complexType name="MTOrbMagneticMomentsType">
      <xsd:sequence maxOccurs="unbounded">
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="orbMagMoment" type="MagneticMomentType"/>
      </xsd:sequence>
      <xsd:attribute name="units" type="xsd:string" use="optional"/>
   </xsd:complexType>

   <xsd:complexType name="MagneticMomentType">
      <xsd:attribute name="atomType" type="xsd:integer" use="required"/>
      <xsd:attribute name="moment" type="xsd:double" use="required"/>
      <xsd:attribute name="spinUpCharge" type="xsd:double" use="required"/>
      <xsd:attribute name="spinDownCharge" type="xsd:double" use="required"/>
   </xsd:complexType>

   <xsd:complexType name="OutStateType">
      <xsd:attribute name="n" type="xsd:integer" use="required"/>
      <xsd:attribute name="l" type="xsd:integer" use="required"/>
      <xsd:attribute name="j" type="xsd:double" use="required"/>
      <xsd:attribute name="energy" type="xsd:double" use="required"/>
      <xsd:attribute name="weight" type="xsd:double" use="required"/>
   </xsd:complexType>

   <xsd:complexType name="OutTotalForcesType">
      <xsd:sequence>
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="forceTotal" type="ForceTotalType"/>
      </xsd:sequence>
      <xsd:attribute name="units" type="xsd:string" use="optional"/>
   </xsd:complexType>

   <xsd:complexType name="ForceTotalType">
      <xsd:attribute name="atomType" type="xsd:integer" use="required"/>
      <xsd:attribute name="x" type="xsd:double" use="required"/>
      <xsd:attribute name="y" type="xsd:double" use="required"/>
      <xsd:attribute name="z" type="xsd:double" use="required"/>
      <xsd:attribute name="F_x" type="xsd:double" use="required"/>
      <xsd:attribute name="F_y" type="xsd:double" use="required"/>
      <xsd:attribute name="F_z" type="xsd:double" use="required"/>
      <xsd:attribute name="units" type="xsd:string" use="optional"/>
   </xsd:complexType>

   <xsd:complexType name="TotalEnergyType">
      <xsd:sequence maxOccurs="unbounded">
         <xsd:element maxOccurs="1" minOccurs="0" name="sumOfEigenvalues" type="SumOfEigenvaluesType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="densityCoulombPotentialIntegral" type="SingleValueType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="densityEffectivePotentialIntegral" type="SingleValueType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="chargeDenXCDenIntegral" type="SingleValueType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="FockExchangeEnergyValence" type="SingleValueType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="FockExchangeEnergyCore" type="SingleValueType"/>
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="atomTypeDependentContributions" type="AtomTypeDependentContributionsType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="tkbTimesEntropy" type="SingleValueType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="freeEnergy" type="SingleValueType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="extrapolationTo0K" type="SingleValueType"/>
      </xsd:sequence>
      <xsd:attribute name="value" type="xsd:double" use="required"/>
      <xsd:attribute name="units" type="xsd:string" use="optional"/>
   </xsd:complexType>

   <xsd:complexType name="SumOfEigenvaluesType">
      <xsd:all>
         <xsd:element maxOccurs="1" minOccurs="0" name="coreElectrons" type="SingleValueType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="valenceElectrons" type="SingleValueType"/>
      </xsd:all>
      <xsd:attribute name="value" type="xsd:double" use="required"/>
      <xsd:attribute name="units" type="xsd:string" use="optional"/>
   </xsd:complexType>

   <xsd:complexType name="AtomTypeDependentContributionsType">
      <xsd:all>
         <xsd:element maxOccurs="1" minOccurs="0" name="electronNucleiInteractionDifferentMTs" type="SingleValueType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="MadelungTerm" type="SingleValueType"/>
      </xsd:all>
      <xsd:attribute name="atomType" type="xsd:integer" use="required"/>
   </xsd:complexType>

   <xsd:complexType name="DensityConvergenceType">
      <xsd:sequence maxOccurs="unbounded">
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="chargeDensity" type="DensityDistanceType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="overallChargeDensity" type="DensityDistanceType"/>
         <xsd:element maxOccurs="1" minOccurs="0" name="spinDensity" type="DensityDistanceType"/>
      </xsd:sequence>
      <xsd:attribute name="units" type="xsd:string" use="optional"/>
   </xsd:complexType>

   <xsd:complexType name="DensityDistanceType">
      <xsd:attribute name="spin" type="xsd:integer" use="optional"/>
      <xsd:attribute name="distance" type="xsd:double" use="required"/>
      <xsd:attribute name="units" type="xsd:string" use="optional"/>
   </xsd:complexType>

   <xsd:complexType name="TimingType">
      <xsd:sequence maxOccurs="unbounded">
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="compositeTimer" type="CompositeTimerType"/>
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="timer" type="TimerType"/>
      </xsd:sequence>
      <xsd:attribute name="units" type="xsd:string" use="optional"/>
   </xsd:complexType>

   <xsd:complexType name="CompositeTimerType">
      <xsd:sequence maxOccurs="unbounded">
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="compositeTimer" type="CompositeTimerType"/>
         <xsd:element maxOccurs="unbounded" minOccurs="0" name="timer" type="TimerType"/>
      </xsd:sequence>
      <xsd:attribute name="name" type="xsd:string" use="required"/>
      <xsd:attribute name="value" type="xsd:double" use="required"/>
      <xsd:attribute name="units" type="xsd:string" use="optional"/>
   </xsd:complexType>

   <xsd:complexType name="TimerType">
      <xsd:attribute name="name" type="xsd:string" use="required"/>
      <xsd:attribute name="value" type="xsd:double" use="required"/>
      <xsd:attribute name="units" type="xsd:string" use="optional"/>
   </xsd:complexType>

</xsd:schema>
