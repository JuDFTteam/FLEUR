jpInit:

! Type parameters
type(t_atoms),                    intent(out) :: atoms
type(t_cell),                     intent(out) :: cell
type(t_sym),                      intent(out) :: sym
type(t_stars),                    intent(out) :: stars
type(t_sphhar),                   intent(out) :: lathar
type(t_input),                    intent(out) :: input
type(t_dimension),                intent(out) :: dimens
type(t_enpara),                   intent(out) :: enpara
type(t_xcpot),                    intent(out) :: xcpot
type(t_kpts),                     intent(out) :: kpts
type(t_kpts),                     intent(out) :: qpts
type(t_potential),                intent(out) :: Veff0
type(t_usdus),                    intent(out) :: usdus
type(t_results),                  intent(out) :: results

! Scalar parameters
integer,                          intent(in)  :: logUnit !
integer,                          intent(in)  :: startTime(8)
integer,                          intent(out) :: iqpt
real,                             intent(out) :: paPoX
real,                             intent(out) :: paPoY
real,                             intent(out) :: paPoZ
logical,                          intent(out) :: harSw
logical,                          intent(out) :: extSw
logical,                          intent(out) :: xcSw
logical,                          intent(out) :: calcEigenVec
logical,                          intent(out) :: oneSternhCycle
logical,                          intent(out) :: recipLengthUnit
logical,                          intent(out) :: onlyTests
logical,                          intent(out) :: testsActivated
integer,                          intent(out) :: noPtsCon
integer,                          intent(out) :: ngdp
integer,                          intent(out) :: ngdp2km
integer,                          intent(out) :: memd_atom
integer,                          intent(out) :: numAddQs
logical,                          intent(out) :: testCompareGrVeff0FleurSw
logical,                          intent(out) :: testVeff1Sw
logical,                          intent(out) :: testUnfoldStarsSw
logical,                          intent(out) :: testRadDerivativeSw
logical,                          intent(out) :: testGauntCoeffSw
logical,                          intent(out) :: testGradLhExpandFuncSw
logical,                          intent(out) :: testContGrVeff0Sw
logical,                          intent(out) :: testWarpingSw
logical,                          intent(out) :: testSternhHSMEtestSw
logical,                          intent(out) :: testSternhSchroedPertTheoSw
logical,                          intent(out) :: testz1Phi0ContSw
logical,                          intent(out) :: testRho1BasCorrSw
logical,                          intent(out) :: testPlotRho03Dsw
logical,                          intent(out) :: testRadSolSw
logical,                          intent(out) :: testKptsWeightSw
logical,                          intent(out) :: testCountValElecSw
logical,                          intent(out) :: testVeff0ContSw
logical,                          intent(out) :: testrho0ContSw
logical,                          intent(out) :: testBackRotMTCoordSysSw
logical,                          intent(out) :: testRho1IRsw
logical,                          intent(out) :: testRho1MTsw
logical,                          intent(out) :: testPsi0ContSw
logical,                          intent(out) :: testOverlapSw
logical,                          intent(out) :: testGradRho0PathSw
logical,                          intent(out) :: testEii2LatPeriodQSw
logical,                          intent(out) :: testVarphiHepsVarphiSw
logical,                          intent(out) :: test1st2ndPulDynMatEps1
logical,                          intent(out) :: test1st2ndPulDynMatCancel
logical,                          intent(out) :: test3rdPulDynMatCancel
logical,                          intent(out) :: testIntVeff1Rho1Val
logical,                          intent(out) :: testGrPsiPsiMatElem
logical,                          intent(out) :: testCompareSurfInt
logical,                          intent(out) :: testSplitMTSurfIntSterh
logical,                          intent(out) :: testVeff1IRMESternh
logical,                          intent(out) :: testEps1q0
logical,                          intent(out) :: testVeff1IRMatqBackFold
logical,                          intent(out) :: testVeff1IRqLatPeriod
logical,                          intent(out) :: testGrMatElemPsiHepsPsiGaussTheo
logical,                          intent(out) :: testPsiHepsTildePsi
logical,                          intent(out) :: testGoldsteinRemaining
logical,                          intent(out) :: testR2orNotWfMtGradNgrNTensGrOvls
logical,                          intent(out) :: testComp3ArgSFIntsSw
logical,                          intent(out) :: testComp2ArgSFIntsSw
logical,                          intent(out) :: testGoldsteinSurfSw
logical,                          intent(out) :: testComp2ArgGrSFIntsSw
logical,                          intent(out) :: testIRIntegralSw
logical,                          intent(out) :: testIR3rdMatElemSw
logical,                          intent(out) :: testActionHgrPhiSw
logical,                          intent(out) :: testXCintegrals
logical,                          intent(out) :: testEii2PsDens

! Array parameters
integer,            allocatable,  intent(out) :: kveclo(:,:)
integer,            allocatable,  intent(out) :: nv(:, :)
integer,            allocatable,  intent(out) :: nRadFun(:,:)
integer,            allocatable,  intent(out) :: iloTable(:, :, :)
integer,            allocatable,  intent(out) :: GbasVec(:, :)
integer,            allocatable,  intent(out) :: ilst(:, :, :)
integer,            allocatable,  intent(out) :: ne(:)
integer,            allocatable,  intent(out) :: mapKpq2K(:, :)
real,               allocatable,  intent(out) :: eig(:,:,:)
real,               allocatable,  intent(out) :: rbas1(:,:,:,:,:)
real,               allocatable,  intent(out) :: rbas2(:,:,:,:,:)
real,               allocatable,  intent(out) :: El(:, :, :, :)
real,               allocatable,  intent(out) :: vrCoul(:, :, :, :)
MCOMPLEX,           allocatable,  intent(out) :: z(:,:,:,:)
complex,            allocatable,  intent(out) :: vpwCoul_uw(:, :)
complex,            allocatable,  intent(out) :: rho0IR(:,:)
real,               allocatable,  intent(out) :: rho0MT(:,:,:,:)
real,               allocatable,  intent(out) :: gridf(:, :)
integer,            allocatable,  intent(out) :: gdp(:,:)
integer,            allocatable,  intent(out) :: mlh_atom(:,:,:)
integer,            allocatable,  intent(out) :: nmem_atom(:, :)
complex,            allocatable,  intent(out) :: clnu_atom(:,:,:)
real,               allocatable,  intent(out) :: uuilon(:, :)
real,               allocatable,  intent(out) :: duilon(:, :)
real,               allocatable,  intent(out) :: ulouilopn(:, :, :)
integer,            allocatable,  intent(out) :: nobd(:, :)
integer,            allocatable,  intent(out) :: ilo2p(:, :)
integer,            allocatable,  intent(out) :: gdp2Ind(:, :, :)
integer,            allocatable,  intent(out) :: kpq2kPrVec(:, :, :)
complex,            allocatable,  intent(out) :: vXC0IR(:, :)
complex,            allocatable,  intent(out) :: eXCIR(:)
real,               allocatable,  intent(out) :: vXC0MT(:, :, :, :)
real,               allocatable,  intent(out) :: eXCMT(:, :, :)
integer,                          intent(out) :: gdp2iLim(2, 3)
complex,            allocatable,  intent(out) :: rho0IRpw(:, :)
complex,            allocatable,  intent(out) :: vEff0IRpw(:, :)
complex,            allocatable,  intent(out) :: vEff0IRPwUw(:, :)
complex,            allocatable,  intent(out) :: rho0MTsh(:, :, :, :)
complex,            allocatable,  intent(out) :: vEff0MTsh(:, :, :, :)

Sternheimer_init:

type(t_atoms),                  intent(in)  :: atoms
type(t_sym),                    intent(in)  :: sym
type(t_cell),                   intent(in)  :: cell
type(t_stars),                  intent(in)  :: stars
type(t_dimension),              intent(in)  :: dimens
type(t_sphhar),                 intent(in)  :: lathar
type(t_enpara),                 intent(in)  :: enpara
type(t_usdus),                  intent(in)  :: uds
type(t_input),                  intent(in)  :: input
type(t_kpts),                   intent(in)  :: qpts ! DEPRECATED shifted G-set
type(t_tlmplm),                 intent(out) :: tdHS0

! Scalar parameters
integer,                        intent(in)  :: logUnit
integer,                        intent(in)  :: ngdp
integer,                        intent(in)  :: iqpt ! DEPRECATED shifted G-set

! Array parameters
integer,                        intent(in)  :: gdp(:, :)
complex,                        intent(in)  :: rho0IR(:, :)
real,                           intent(in)  :: rho0MT(:, 0:, :, :)
integer,                        intent(in)  :: mlh_atom(:,0:,:)
integer,                        intent(in)  :: nmem_atom(0:, :)
complex,                        intent(in)  :: clnu_atom(:,0:,:)
real,                           intent(in)  :: rbas1(:, :, 0:, :, :)
real,                           intent(in)  :: rbas2(:, :, 0:, :, :)
real,                           intent(in)  :: uuilon(:, :)
real,                           intent(in)  :: duilon(:, :)
real,                           intent(in)  :: ulouilopn(:, :, :)
integer,                        intent(in)  :: ilo2p(:, :)
complex,                        intent(in)  :: rho0IRpw(:, :)
complex,                        intent(in)  :: rho0MTsh(:, :, :, :)
complex,                        intent(in)  :: vEff0MTsh(:, :, :, :)
complex,           allocatable, intent(out) :: qpwcG(:, :)
complex,           allocatable, intent(out) :: rho1MTCoreDispAt(:, :, :, :)
complex,           allocatable, intent(out) :: grVxcIRKern(:)
real,              allocatable, intent(out) :: dKernMTGPts(:, :, :)
complex,           allocatable, intent(out) :: grVeff0MT_init(:, :, :, :)
complex,           allocatable, intent(out) :: grVeff0MT_main(:, :, :, :)
complex,           allocatable, intent(out) :: grRho0IR(:, :)
complex,           allocatable, intent(out) :: grRho0MT(:, :, :, :)
real,              allocatable, intent(out) :: gausWts(:)
complex,           allocatable, intent(out) :: ylm(:, :)
complex,           allocatable, intent(out) :: grVext0IR_DM(:, :)
complex,           allocatable, intent(out) :: grVext0MT_DM(:, :, :, :)
complex,           allocatable, intent(out) :: grVCoul0IR_DM_SF(:, :)
complex,           allocatable, intent(out) :: grVCoul0MT_DM_SF(:, :, :, :)
complex,           allocatable, intent(out) :: grVeff0IR_DM(:, :)
complex,           allocatable, intent(out) :: grVeff0MT_DM(:, :, :, :)
complex,           allocatable, intent(out) :: grVeff0MT_DMhxc(:, :, :, :)
