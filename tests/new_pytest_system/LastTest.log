
======================================================= FAILURES =======================================================
___________________________________ test_fleur_mt_outxml_parser[test_SiFilmPlotXML] ____________________________________

request = <FixtureRequest for <Function test_fleur_mt_outxml_parser[test_SiFilmPlotXML]>>
fleur_test_name = 'test_SiFilmPlotXML', test_file = 'tests/feature_reg/test_SiFilm.py'
parser_testdir = '/Users/janssen/GIT/fleur/build.dev/Testing/parser_testdir'

    @pytest.mark.fleur_parser
    @pytest.mark.masci_tools
    def test_fleur_mt_outxml_parser(request, fleur_test_name, test_file, parser_testdir):
        """
        For each folder (parametrization happens in conftest.py) in parser test,
        try if the fleur parser in masci-tools can handle the parsing without
        crashing, successful and an empty parser log
        """
        #Note:
        #   You might notice that a lot of the output parser tests fail either because the out file does not validate
        #   Or there are warnings
        #   1. The validation errors occur since the schemas in fleur (develop) and masci-tools are slightly out of sync
        #      at the moment (fixed in the raise_fleur_file_version branch)
        #   2. There are a couple of output differences not yet accounted for in the output parser (Some could be solved in fleur)
        #           - bandgap output only in hist mode
    
        #These warnings are expected to appear at the moment
        KNOWN_WARNINGS = {'No values found for attribute potential',
                          'No values found for attribute chargeDensity',
                          'No values found for attribute l_f'}
    
        pytest.importorskip('masci_tools',minversion='0.4.0-dev3')
        from masci_tools.io.parsers.fleur import outxml_parser
        depends(request, [f'{test_file}::{fleur_test_name}'], scope='session')
    
        outxmlfilepath = os.path.abspath(os.path.join(parser_testdir, f'./{fleur_test_name}/', 'out.xml'))
    
        assert os.path.isfile(outxmlfilepath)
    
        parser_info = {}
        out_dict = outxml_parser(outxmlfilepath, parser_info_out=parser_info)
    
        assert out_dict is not None
        assert isinstance(out_dict, dict)
        assert out_dict != {}
>       assert set(parser_info['parser_warnings']).difference(KNOWN_WARNINGS) == set() #At the moment there is always at least one warning
E       assert {"[Iteration ...tribute", ...} == set()
E         Extra items in the left set:
E         '[Iteration 1] No values found for attribute value at tag coreElectrons'
E         "[Iteration 1] Failed to evaluate singleValue from tag sumOfEigenvalues: Has no 'value' attribute"
E         "[Iteration 1] Failed to evaluate singleValue from tag bandgap: Has no 'units' attribute"
E         "[Iteration 1] Failed to evaluate singleValue from tag totalEnergy: Has no 'value' attribute"
E         '[Iteration 1] No values found for attribute value at tag sumOfEigenvalues'
E         '[Iteration 1] No values found for attribute value at tag valenceElectrons'...
E         
E         ...Full output truncated (24 lines hidden), use '-vv' to show

tests/masci_tools/test_fleur_parser.py:65: AssertionError
-------------------------------------------------- Captured log call ---------------------------------------------------
[32mINFO    [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:fleur_outxml_parser.py:97 Masci-Tools Fleur out.xml Parser v0.5.0
[32mINFO    [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:fleur_outxml_parser.py:201 Found fleur out file with the versions out: 0.34; inp: 0.34
[32mINFO    [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:fleur_outxml_parser.py:349 The following defined constants were found: {'Pi': 3.141592653589793, 'Deg': 0.017453292519943295, 'Ang': 1.889726124772898, 'nm': 18.89726124772898, 'pm': 0.01889726124772898, 'Bohr': 1.0, 'Htr': 1.0, 'eV': 0.03674932217565499, 'Ry': 0.5}
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:467 No values found for attribute l_f
[32mINFO    [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:fleur_outxml_parser.py:353 The following Fleur modes were found: {'jspin': 1, 'noco': False, 'soc': False, 'relax': False, 'gw': False, 'force_theorem': False, 'cf_coeff': False, 'film': True, 'ldau': False, 'dos': False, 'band': False, 'bz_integration': 'hist'}
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute units at tag totalEnergy
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag totalEnergy
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag totalEnergy: Has no 'value' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:708 [Iteration 1] Failed to evaluate singleValue from tag totalEnergy: Has no 'units' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:outxml_conversions.py:51 [Iteration 1] convert_total_energy cannot convert None to eV
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:467 [Iteration 1] No values found for attribute distance
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:467 [Iteration 1] No values found for attribute units
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag sumOfEigenvalues
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag sumOfEigenvalues: Has no 'value' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag coreElectrons
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag coreElectrons: Has no 'value' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag valenceElectrons
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag valenceElectrons: Has no 'value' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag chargeDenXCDenIntegral
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag chargeDenXCDenIntegral: Has no 'value' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute units at tag FermiEnergy
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag FermiEnergy
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag FermiEnergy: Has no 'value' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:708 [Iteration 1] Failed to evaluate singleValue from tag FermiEnergy: Has no 'units' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute units at tag bandgap
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag bandgap
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag bandgap: Has no 'value' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:708 [Iteration 1] Failed to evaluate singleValue from tag bandgap: Has no 'units' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute interstitial at tag spinDependentCharge
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute mtSpheres at tag spinDependentCharge
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute total at tag spinDependentCharge
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag totalCharge
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag totalCharge: Has no 'value' attribute
_________________________________ test_fleur_mt_outxml_parser[test_SiFilmSlicePlotXML] _________________________________

request = <FixtureRequest for <Function test_fleur_mt_outxml_parser[test_SiFilmSlicePlotXML]>>
fleur_test_name = 'test_SiFilmSlicePlotXML', test_file = 'tests/feature_reg/test_SiFilm.py'
parser_testdir = '/Users/janssen/GIT/fleur/build.dev/Testing/parser_testdir'

    @pytest.mark.fleur_parser
    @pytest.mark.masci_tools
    def test_fleur_mt_outxml_parser(request, fleur_test_name, test_file, parser_testdir):
        """
        For each folder (parametrization happens in conftest.py) in parser test,
        try if the fleur parser in masci-tools can handle the parsing without
        crashing, successful and an empty parser log
        """
        #Note:
        #   You might notice that a lot of the output parser tests fail either because the out file does not validate
        #   Or there are warnings
        #   1. The validation errors occur since the schemas in fleur (develop) and masci-tools are slightly out of sync
        #      at the moment (fixed in the raise_fleur_file_version branch)
        #   2. There are a couple of output differences not yet accounted for in the output parser (Some could be solved in fleur)
        #           - bandgap output only in hist mode
    
        #These warnings are expected to appear at the moment
        KNOWN_WARNINGS = {'No values found for attribute potential',
                          'No values found for attribute chargeDensity',
                          'No values found for attribute l_f'}
    
        pytest.importorskip('masci_tools',minversion='0.4.0-dev3')
        from masci_tools.io.parsers.fleur import outxml_parser
        depends(request, [f'{test_file}::{fleur_test_name}'], scope='session')
    
        outxmlfilepath = os.path.abspath(os.path.join(parser_testdir, f'./{fleur_test_name}/', 'out.xml'))
    
        assert os.path.isfile(outxmlfilepath)
    
        parser_info = {}
        out_dict = outxml_parser(outxmlfilepath, parser_info_out=parser_info)
    
        assert out_dict is not None
        assert isinstance(out_dict, dict)
        assert out_dict != {}
>       assert set(parser_info['parser_warnings']).difference(KNOWN_WARNINGS) == set() #At the moment there is always at least one warning
E       assert {"[Iteration ...tribute", ...} == set()
E         Extra items in the left set:
E         '[Iteration 1] No values found for attribute value at tag coreElectrons'
E         "[Iteration 1] Failed to evaluate singleValue from tag sumOfEigenvalues: Has no 'value' attribute"
E         "[Iteration 1] Failed to evaluate singleValue from tag bandgap: Has no 'units' attribute"
E         "[Iteration 1] Failed to evaluate singleValue from tag totalEnergy: Has no 'value' attribute"
E         '[Iteration 1] No values found for attribute value at tag sumOfEigenvalues'
E         '[Iteration 1] No values found for attribute value at tag valenceElectrons'...
E         
E         ...Full output truncated (24 lines hidden), use '-vv' to show

tests/masci_tools/test_fleur_parser.py:65: AssertionError
-------------------------------------------------- Captured log call ---------------------------------------------------
[32mINFO    [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:fleur_outxml_parser.py:97 Masci-Tools Fleur out.xml Parser v0.5.0
[32mINFO    [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:fleur_outxml_parser.py:201 Found fleur out file with the versions out: 0.34; inp: 0.34
[32mINFO    [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:fleur_outxml_parser.py:349 The following defined constants were found: {'Pi': 3.141592653589793, 'Deg': 0.017453292519943295, 'Ang': 1.889726124772898, 'nm': 18.89726124772898, 'pm': 0.01889726124772898, 'Bohr': 1.0, 'Htr': 1.0, 'eV': 0.03674932217565499, 'Ry': 0.5}
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:467 No values found for attribute l_f
[32mINFO    [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:fleur_outxml_parser.py:353 The following Fleur modes were found: {'jspin': 1, 'noco': False, 'soc': False, 'relax': False, 'gw': False, 'force_theorem': False, 'cf_coeff': False, 'film': True, 'ldau': False, 'dos': False, 'band': False, 'bz_integration': 'hist'}
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute units at tag totalEnergy
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag totalEnergy
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag totalEnergy: Has no 'value' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:708 [Iteration 1] Failed to evaluate singleValue from tag totalEnergy: Has no 'units' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:outxml_conversions.py:51 [Iteration 1] convert_total_energy cannot convert None to eV
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:467 [Iteration 1] No values found for attribute distance
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:467 [Iteration 1] No values found for attribute units
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag sumOfEigenvalues
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag sumOfEigenvalues: Has no 'value' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag coreElectrons
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag coreElectrons: Has no 'value' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag valenceElectrons
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag valenceElectrons: Has no 'value' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag chargeDenXCDenIntegral
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag chargeDenXCDenIntegral: Has no 'value' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute units at tag FermiEnergy
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag FermiEnergy
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag FermiEnergy: Has no 'value' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:708 [Iteration 1] Failed to evaluate singleValue from tag FermiEnergy: Has no 'units' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute units at tag bandgap
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag bandgap
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag bandgap: Has no 'value' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:708 [Iteration 1] Failed to evaluate singleValue from tag bandgap: Has no 'units' attribute
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute interstitial at tag spinDependentCharge
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute mtSpheres at tag spinDependentCharge
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute total at tag spinDependentCharge
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:646 [Iteration 1] No values found for attribute value at tag totalCharge
[33mWARNING [0m masci_tools.io.parsers.fleur.fleur_outxml_parser:schema_dict_util.py:702 [Iteration 1] Failed to evaluate singleValue from tag totalCharge: Has no 'value' attribute