#juDFT Testscript

jt::copyfile("files/inp.xml",$workdir);

jt::testrun("$executable ",$workdir);

#Check that the ouput for crystalfield calculations is written
$result =jt::test_fileexists("$workdir/out");


if(jt::test_fileexists("$workdir/cdn.hdf") == 0){
   #Test for some of the text output files
   $result+=jt::test_fileexists("$workdir/n4f.1.dat");
   $result+=jt::test_fileexists("$workdir/V_20.1.dat");
   $result+=jt::test_fileexists("$workdir/V_40.1.dat");
   $result+=jt::test_fileexists("$workdir/V_60.1.dat");
   $result+=jt::test_fileexists("$workdir/V_66.1.dat");
}else{
   $result+=jt::test_fileexists("$workdir/CFdata.hdf");
}




#Test that there was a second vgen call with modified potential
#Here the big multipole moments are grepped (Maybe not the best way)
$result+=jt::grep_exists("$workdir/out"," 0    0          -0.14208E+01");
$result+=jt::grep_exists("$workdir/out"," 2    0          -0.58864E+00");
$result+=jt::grep_exists("$workdir/out"," 4    0           0.72534E+00");
$result+=jt::grep_exists("$workdir/out"," 6    0          -0.61349E+01");
jt::stageresult($workdir,$result,"1");
