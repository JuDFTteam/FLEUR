#juDFT Testscript

jt::copyfile("files/inp.xml",$workdir);
#if strings starts with mpi
$mpi="mpirun -n 3 --allow-run-as-root ";

jt::testrun("$executable ",$workdir);

#now test output

# Test of total energy from 1st HF iteration
# old fleur result: -4205.2193167587, new fleur result: -4205.2193168070
$result=jt::test_grepnumber("$workdir/out","HF total energy="," *= *([^ ]*)",-4204.9174214647,0.000001);
# Test of total energy from 2nd HF iteration
# old fleur result: -4204.9174283564, new fleur result -4204.9174214633
# Differences probably due to recomputation of mixed product basis in every HF iteration in ne fleur
 $result+=jt::test_grepexists("$workdir/out","HF total energy.*-4205.2193168");

# Test of bandgap from 2nd HF iteration
$result+=jt::test_grepexists("$workdir/out","bandgap.*0.09105");

jt::stageresult($workdir,$result,"1");
